services:
  siloPreprocessing:
    image: ghcr.io/genspectrum/lapis-silo:0.8.5
    command: preprocessing
    user: "${WISEPULSE_UID:-1006}:${WISEPULSE_GID:-1006}"
    mem_limit: 350g
    volumes:
      - type: bind
        source: ./silo_output
        target: /preprocessing/output
        read_only: false
      - type: bind
        source: ./preprocessing_config.yaml
        target: /app/preprocessing_config.yaml
        read_only: true
      - type: bind
        source: ./
        target: /preprocessing/input
        read_only: false
      - type: bind
        source: ./logs
        target: /app/logs
        read_only: false
    stop_grace_period: 5s
